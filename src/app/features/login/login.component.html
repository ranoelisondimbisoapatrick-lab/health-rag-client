<div class="auth-shell">
  <mat-card class="auth-card">
    <mat-card-header class="auth-header">
      <mat-card-title>Health RAG AI</mat-card-title>
      <mat-card-subtitle>Connexion sécurisée</mat-card-subtitle>
    </mat-card-header>

    <!-- Toggle -->
    <div class="mode-toggle">
      <button mat-button [color]="mode==='login' ? 'primary' : undefined" (click)="mode='login'">
        Connexion
      </button>
      <button mat-button [color]="mode==='register' ? 'primary' : undefined" (click)="mode='register'">
        Inscription
      </button>
    </div>

    <mat-card-content>
      <!-- Error -->
      <div class="error" *ngIf="errorMessage">
        <mat-icon>error</mat-icon>
        <span>{{ errorMessage }}</span>
      </div>

      <form (ngSubmit)="onSubmit()">
        <mat-form-field appearance="outline" class="full">
          <mat-label>Nom d'utilisateur</mat-label>
          <input
            matInput
            [(ngModel)]="username"
            name="username"
            autocomplete="username"
            required
          />
        </mat-form-field>

        <mat-form-field appearance="outline" class="full">
          <mat-label>Mot de passe</mat-label>
          <input
            matInput
            [(ngModel)]="password"
            name="password"
            type="password"
            autocomplete="current-password"
            required
          />
        </mat-form-field>

        <button mat-raised-button color="primary" class="full" type="submit" [disabled]="isSubmitting">
          <mat-icon>lock</mat-icon>
          <span *ngIf="!isSubmitting">{{ mode === 'login' ? 'Se connecter' : "S'inscrire" }}</span>
          <mat-progress-spinner
            *ngIf="isSubmitting"
            diameter="18"
            mode="indeterminate"
          ></mat-progress-spinner>
        </button>
      </form>
    </mat-card-content>
  </mat-card>
</div>
